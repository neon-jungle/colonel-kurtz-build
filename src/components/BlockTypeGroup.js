'use strict';

var Animator = require('./Animator');
var FocusTrap = require('react-focus-trap');
var React = require('react');
var Btn = require('./Button');

module.exports = React.createClass({
  displayName: 'exports',

  getDefaultProps: function getDefaultProps() {
    return {
      items: []
    };
  },

  getInitialState: function getInitialState() {
    return {
      open: false
    };
  },

  open: function open() {
    this.setState({ open: true });
  },

  close: function close() {
    this.setState({ open: false });
  },

  getButton: function getButton(type) {
    var id = type.id;
    var label = type.label;
    var onAdd = this.props.onAdd;

    return React.createElement(
      Btn,
      { key: id, className: 'col-menu-item', onClick: function () {
          return onAdd(type);
        } },
      label
    );
  },

  getMenu: function getMenu() {
    return this.state.open ? React.createElement(
      FocusTrap,
      { key: 'menu', className: 'col-menu', element: 'nav', active: true, onExit: this.close, role: 'navigation' },
      this.props.items.map(this.getButton)
    ) : null;
  },

  render: function render() {
    return React.createElement(
      Animator,
      { 'aria-role': 'button', transitionName: 'col-menu', className: 'col-switch-dropdown', transitionEnterTimeout: 300, transitionLeaveTimeout: 200, onKeyUp: this._onKeyUp },
      React.createElement(
        Btn,
        { key: 'label', className: 'col-switch-btn col-menu-label', onClick: this.open },
        this.props.label
      ),
      this.getMenu()
    );
  },

  _onKeyUp: function _onKeyUp(e) {
    // Do not allow escape presses to bubble up to parent switch
    if (e.key === 'Escape' && this.state.open) {
      e.stopPropagation();
    }
  }

});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL0Jsb2NrVHlwZUdyb3VwLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksUUFBUSxHQUFJLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQTtBQUNyQyxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQTtBQUMzQyxJQUFJLEtBQUssR0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDaEMsSUFBSSxHQUFHLEdBQVMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFBOztBQUVuQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUM7OztBQUVqQyxpQkFBZSxFQUFBLDJCQUFHO0FBQ2hCLFdBQU87QUFDTCxXQUFLLEVBQUcsRUFBRTtLQUNYLENBQUE7R0FDRjs7QUFFRCxpQkFBZSxFQUFBLDJCQUFHO0FBQ2hCLFdBQU87QUFDTCxVQUFJLEVBQUUsS0FBSztLQUNaLENBQUE7R0FDRjs7QUFFRCxNQUFJLEVBQUEsZ0JBQUc7QUFDTCxRQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7R0FDOUI7O0FBRUQsT0FBSyxFQUFBLGlCQUFHO0FBQ04sUUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFBO0dBQy9COztBQUVELFdBQVMsRUFBQSxtQkFBQyxJQUFJLEVBQUU7UUFDUixFQUFFLEdBQVksSUFBSSxDQUFsQixFQUFFO1FBQUUsS0FBSyxHQUFLLElBQUksQ0FBZCxLQUFLO1FBQ1QsS0FBSyxHQUFLLElBQUksQ0FBQyxLQUFLLENBQXBCLEtBQUs7O0FBRVgsV0FDRTtBQUFDLFNBQUc7UUFBQyxHQUFHLEVBQUcsRUFBRSxBQUFFLEVBQUMsU0FBUyxFQUFDLGVBQWUsRUFBQyxPQUFPLEVBQUc7aUJBQU0sS0FBSyxDQUFDLElBQUksQ0FBQztTQUFBLEFBQUU7TUFDbkUsS0FBSztLQUNILENBQ1A7R0FDRjs7QUFFRCxTQUFPLEVBQUEsbUJBQUc7QUFDUixXQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUNwQjtBQUFDLGVBQVM7UUFBQyxHQUFHLEVBQUMsTUFBTSxFQUFDLFNBQVMsRUFBQyxVQUFVLEVBQUMsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLE1BQUEsRUFBQyxNQUFNLEVBQUcsSUFBSSxDQUFDLEtBQUssQUFBRSxFQUFDLElBQUksRUFBQyxZQUFZO01BQ25HLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO0tBQzVCLEdBQ1YsSUFBSSxDQUFBO0dBQ1Q7O0FBRUQsUUFBTSxFQUFBLGtCQUFHO0FBQ1AsV0FDRTtBQUFDLGNBQVE7UUFBQyxhQUFVLFFBQVEsRUFBQyxjQUFjLEVBQUMsVUFBVSxFQUFDLFNBQVMsRUFBQyxxQkFBcUIsRUFBQyxzQkFBc0IsRUFBRyxHQUFHLEFBQUUsRUFBQyxzQkFBc0IsRUFBRyxHQUFHLEFBQUUsRUFBQyxPQUFPLEVBQUcsSUFBSSxDQUFDLFFBQVEsQUFBRTtNQUM1SztBQUFDLFdBQUc7VUFBQyxHQUFHLEVBQUMsT0FBTyxFQUFDLFNBQVMsRUFBQywrQkFBK0IsRUFBQyxPQUFPLEVBQUcsSUFBSSxDQUFDLElBQUksQUFBRTtRQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSztPQUFRO01BQ3pHLElBQUksQ0FBQyxPQUFPLEVBQUU7S0FDUCxDQUNaO0dBQ0Y7O0FBRUQsVUFBUSxFQUFBLGtCQUFDLENBQUMsRUFBRTs7QUFFVixRQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFO0FBQ3pDLE9BQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQTtLQUNwQjtHQUNGOztDQUVGLENBQUMsQ0FBQSIsImZpbGUiOiJCbG9ja1R5cGVHcm91cC5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBBbmltYXRvciAgPSByZXF1aXJlKCcuL0FuaW1hdG9yJylcbmxldCBGb2N1c1RyYXAgPSByZXF1aXJlKCdyZWFjdC1mb2N1cy10cmFwJylcbmxldCBSZWFjdCAgICAgPSByZXF1aXJlKCdyZWFjdCcpXG5sZXQgQnRuICAgICAgID0gcmVxdWlyZSgnLi9CdXR0b24nKVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblxuICBnZXREZWZhdWx0UHJvcHMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGl0ZW1zIDogW11cbiAgICB9XG4gIH0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlKCkge1xuICAgIHJldHVybiB7XG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH1cbiAgfSxcblxuICBvcGVuKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuOiB0cnVlIH0pXG4gIH0sXG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW46IGZhbHNlIH0pXG4gIH0sXG5cbiAgZ2V0QnV0dG9uKHR5cGUpIHtcbiAgICBsZXQgeyBpZCwgbGFiZWwgfSA9IHR5cGVcbiAgICBsZXQgeyBvbkFkZCB9ID0gdGhpcy5wcm9wc1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxCdG4ga2V5PXsgaWQgfSBjbGFzc05hbWU9XCJjb2wtbWVudS1pdGVtXCIgb25DbGljaz17ICgpID0+IG9uQWRkKHR5cGUpIH0+XG4gICAgICAgIHsgbGFiZWwgfVxuICAgICAgPC9CdG4+XG4gICAgKVxuICB9LFxuXG4gIGdldE1lbnUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUub3BlbiA/IChcbiAgICAgIDxGb2N1c1RyYXAga2V5PVwibWVudVwiIGNsYXNzTmFtZT1cImNvbC1tZW51XCIgZWxlbWVudD1cIm5hdlwiIGFjdGl2ZSBvbkV4aXQ9eyB0aGlzLmNsb3NlIH0gcm9sZT1cIm5hdmlnYXRpb25cIj5cbiAgICAgICAgeyB0aGlzLnByb3BzLml0ZW1zLm1hcCh0aGlzLmdldEJ1dHRvbikgfVxuICAgICAgPC9Gb2N1c1RyYXA+XG4gICAgKSA6IG51bGxcbiAgfSxcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmltYXRvciBhcmlhLXJvbGU9XCJidXR0b25cIiB0cmFuc2l0aW9uTmFtZT1cImNvbC1tZW51XCIgY2xhc3NOYW1lPVwiY29sLXN3aXRjaC1kcm9wZG93blwiIHRyYW5zaXRpb25FbnRlclRpbWVvdXQ9eyAzMDAgfSB0cmFuc2l0aW9uTGVhdmVUaW1lb3V0PXsgMjAwIH0gb25LZXlVcD17IHRoaXMuX29uS2V5VXAgfT5cbiAgICAgICAgPEJ0biBrZXk9XCJsYWJlbFwiIGNsYXNzTmFtZT1cImNvbC1zd2l0Y2gtYnRuIGNvbC1tZW51LWxhYmVsXCIgb25DbGljaz17IHRoaXMub3BlbiB9PnsgdGhpcy5wcm9wcy5sYWJlbCB9PC9CdG4+XG4gICAgICAgIHsgdGhpcy5nZXRNZW51KCkgfVxuICAgICAgPC9BbmltYXRvcj5cbiAgICApXG4gIH0sXG5cbiAgX29uS2V5VXAoZSkge1xuICAgIC8vIERvIG5vdCBhbGxvdyBlc2NhcGUgcHJlc3NlcyB0byBidWJibGUgdXAgdG8gcGFyZW50IHN3aXRjaFxuICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScgJiYgdGhpcy5zdGF0ZS5vcGVuKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgfVxuICB9XG5cbn0pXG4iXX0=